# Test that causing setting greater than 33 lock collisions does not cause a hang and runaway shared memory usage
# Testing 100 lock collisions when ydb_lockhash_n_bits=1
# The value of sgmnt_data.lock_hash_bucket_full_cntr should be 70 as all the buckets are full after the 30th lock
Files Created in ##TEST_PATH##:
Using: ##SOURCE_PATH##/mumps -run GDE
mumps.gld
Using: ##SOURCE_PATH##/mupip
mumps.dat
##TEST_AWK\[1\] [0-9]*
lock +^a(1)
lock +^a(2)
lock +^a(3)
lock +^a(4)
lock +^a(5)
lock +^a(6)
lock +^a(7)
lock +^a(8)
lock +^a(9)
lock +^a(10)
lock +^a(11)
lock +^a(12)
lock +^a(13)
lock +^a(14)
lock +^a(15)
lock +^a(16)
lock +^a(17)
lock +^a(18)
lock +^a(19)
lock +^a(20)
lock +^a(21)
lock +^a(22)
lock +^a(23)
lock +^a(24)
lock +^a(25)
lock +^a(26)
lock +^a(27)
lock +^a(28)
lock +^a(29)
lock +^a(30)
lock +^a(31)
lock +^a(32)
lock +^a(33)
lock +^a(34)
lock +^a(35)
lock +^a(36)
lock +^a(37)
lock +^a(38)
lock +^a(39)
lock +^a(40)
lock +^a(41)
lock +^a(42)
lock +^a(43)
lock +^a(44)
lock +^a(45)
lock +^a(46)
lock +^a(47)
lock +^a(48)
lock +^a(49)
lock +^a(50)
lock +^a(51)
lock +^a(52)
lock +^a(53)
lock +^a(54)
lock +^a(55)
lock +^a(56)
lock +^a(57)
lock +^a(58)
lock +^a(59)
lock +^a(60)
lock +^a(61)
lock +^a(62)
lock +^a(63)
lock +^a(64)
lock +^a(65)
lock +^a(66)
lock +^a(67)
lock +^a(68)
lock +^a(69)
lock +^a(70)
lock +^a(71)
lock +^a(72)
lock +^a(73)
lock +^a(74)
lock +^a(75)
lock +^a(76)
lock +^a(77)
lock +^a(78)
lock +^a(79)
lock +^a(80)
lock +^a(81)
lock +^a(82)
lock +^a(83)
lock +^a(84)
lock +^a(85)
lock +^a(86)
lock +^a(87)
lock +^a(88)
lock +^a(89)
lock +^a(90)
lock +^a(91)
lock +^a(92)
lock +^a(93)
lock +^a(94)
lock +^a(95)
lock +^a(96)
lock +^a(97)
lock +^a(98)
lock +^a(99)
lock +^a(100)
PASS: numCollisions is correctly 70
PASS: lockhashloopA got ^a(100)
[1]  + Done                          ##SOURCE_PATH##/mumps -run lockMonitorA^ydb439
##SOURCE_PATH##/mupip
##SOURCE_PATH##/mupip integ -REG *
No errors detected by integ.

# Testing 47 lock collisions when ydb_lockhas_n_bits is unset
# The value of sgmnt_data.lock_hash_bucket_full_cntr should be 16 as all the buckets are full after the 30th lock
Files Created in ##TEST_PATH##:
Using: ##SOURCE_PATH##/mumps -run GDE
mumps.gld
Using: ##SOURCE_PATH##/mupip
mumps.dat
##TEST_AWK\[1\] [0-9]*
lock +^a(1445240077)
lock +^a(4097034630)
lock +^a(4388659035)
lock +^a(4630999867)
lock +^a(5407955935)
lock +^a(6251931759)
lock +^a(11417300836)
lock +^a(10290985601)
lock +^a(11005068295)
lock +^a(11434779216)
lock +^a(12514012645)
lock +^a(12676101741)
lock +^a(17058576286)
lock +^a(18738986112)
lock +^a(18480244186)
lock +^a(17280277179)
lock +^a(18379984114)
lock +^a(24440525326)
lock +^a(21696035853)
lock +^a(25089805580)
lock +^a(25561658649)
lock +^a(29582647612)
lock +^a(30357044280)
lock +^a(27414314996)
lock +^a(32074740586)
lock +^a(28582294681)
lock +^a(31467579889)
lock +^a(36848531774)
lock +^a(46427764934)
lock +^a(41893554996)
lock +^a(48113940994)
lock +^a(43052926029)
lock +^a(44129775493)
lock +^a(47697200707)
lock +^a(54939630888)
lock +^a(55988509030)
lock +^a(57060549750)
lock +^a(51493002061)
lock +^a(60309326336)
lock +^a(53984812611)
lock +^a(54917189673)
lock +^a(61308148430)
lock +^a(56066818915)
lock +^a(56431408489)
lock +^a(63495468474)
lock +^a(68545605854)
lock +^a(66623834096)
PASS: numCollisions is correctly 16
PASS: lockhashloopA got ^a(66623834096)
[1]  + Done                          ##SOURCE_PATH##/mumps -run lockMonitorB^ydb439
##SOURCE_PATH##/mupip
##SOURCE_PATH##/mupip integ -REG *
No errors detected by integ.

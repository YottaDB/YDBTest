# Testing VIEW "[NO]STATSHARE"[:<region-list>]
#### testA ####
# enables or disables database statistics sharing for listed regions which permit such sharing. 
#
# Without the region-list, the command acts on all regions enabled for sharing. 
#
# When a targeted region has sharing disabled, STATSHARE has no immediate effect, 
# but may cause the process to start sharing when MUPIP SET -STATS enables sharing for that region

# Create a 3 region DB with gbl_dir mumps.gld and regions DEFAULT, AREG, and BREG

# Disable sharing for BREG
Database file ##TEST_PATH##/b.dat now has sharing of gvstats set to FALSE
# Run testA of gtm8874.m to test basic VIEW functionality and disabled regions
----------
testA
----------

Check for open region files:

Check Sharing Status:
STATSHARE AREG: 0
STATSHARE BREG: 0
STATSHARE DEFAULT: 0
STATSHARE: 0

VIEW "STATSHARE" 
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 0
STATSHARE DEFAULT: 1
STATSHARE: 1


VIEW "NOSTATSHARE" 
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 0
STATSHARE BREG: 0
STATSHARE DEFAULT: 0
STATSHARE: 0

VIEW "STATSHARE":"AREG"
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 0
STATSHARE DEFAULT: 0
STATSHARE: 1

VIEW "STATSHARE":"DEFAULT"

Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 0
STATSHARE DEFAULT: 1
STATSHARE: 1

VIEW "NOSTATSHARE":"AREG"

Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 0
STATSHARE BREG: 0
STATSHARE DEFAULT: 1
STATSHARE: 1

VIEW "STATSHARE"
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 0
STATSHARE DEFAULT: 1
STATSHARE: 1

VIEW "NOSTATSHARE"
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 0
STATSHARE BREG: 0
STATSHARE DEFAULT: 0
STATSHARE: 0

# Shut down the DB and backup necessary files to sub directory

#### testB ####
# When a targeted region has sharing disabled, STATSHARE has no immediate effect, 
# but may cause the process to start sharing when MUPIP SET -STATS enables sharing for that region
#
# the $gtm_statshare environment variable applies to databases as the application first uses them

# setenv gtm_statshare "TRUE"
# Recreate the 3 region DB with gbl_dir mumps.gld

# Disable sharing for BREG
Database file ##TEST_PATH##/b.dat now has sharing of gvstats set to FALSE
# Run testB1 of gtm8874.m to V[IEW] "STATSHARE" and run $VIEW for each region with gtm_statshare="TRUE"
----------
testB1
----------

VIEW "STATSHARE"
Check for open region files:
a.dat
b.dat
mumps.dat
xxx.a.dat.gst
xxx.mumps.dat.gst

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 0
STATSHARE DEFAULT: 1
STATSHARE: 1

# Enable sharing for BREG
Database file ##TEST_PATH##/b.dat now has sharing of gvstats set to  TRUE
# Run testB2 of gtm8874.m to $VIEW regions
----------
testB2
----------


Check for open region files:

Check Sharing Status:
STATSHARE AREG: 1
STATSHARE BREG: 1
STATSHARE DEFAULT: 1
STATSHARE: 1

unsetenv gtm_statshare
# Shut down the DB and backup necessary files to sub directory

#### testC ####
# VIEW "[NO]STATSHARE" with no region sub-argument opens any unopened mapped regions
# and any enabled associated statsDB regions
#
# When the last VIEW "[NO]STATSHARE" had no region sub-argument, regions implicitly share 
# when the process first references them, but after a VIEW specifies selective sharing, 
Unmatched '''.
